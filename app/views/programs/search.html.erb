<!-- Homepage -->
<div data-role="page">
  <!-- figure out whose page it is -->

  <% person = User.find_by_id(session[:user_id]) %>
  <% if (person == nil) then %>
    <center><h1>
      <%= link_to("Log in to view this page", controller: "users", action: "login") %>
    </h1></center>
  <% else %>
  <%= render "layouts/nav" %>

    <!--Main Page: Contains the main content on the page -->
    <div data-role="main" class="ui-content">
      <h1><center>opportunities</center></h1>


        <div  data-theme="a" id="custom-footer" class="ui-grid-a"  data-position="fixed">
          <div  class="ui-block-a" >
              <a href="#filter_panel" data-role="button" data-mini="true" id ="filter_button" data-inline="true">filter</a>
          </div>
          <div  class="ui-block-b" >
            <input type="search" placeholder="begin searching..." data-mini="true" data-clear-btn="true"/>
          </div>
        </div>


<% return_value = 'cackle' %>
<%= form_tag do %>
  <%= label_tag :Search %>
  <%= text_field_tag :substring, '', :id => "substring" %>
  <%= submit_tag "Search", :id => "html_submit" %>
<% end %>
<br/><br/><br/>
<% @all_programs_ajax.each do |program| %>
  <% if (program.due_date == nil) %>
    <% next %>
  <% end %>
  <center>
    <%= link_to(program.title, controller: "programs", action: "index") %>
    <br/>
  </center>
<% end %>
<% @all_programs_ajax.clear %>

<div id="information"></div>

<%= javascript_tag "var parser = new Parser(" + @all_user_ids.to_json + ", 'html_submit', 'substring', 'information', '<br/><br/><br/>', '<div id=\"information\">')"; %>

<%= @params_test %>



      <h2><center>List of Results</center></h2>
      <% for program in @all_programs %>
        <% if (program.title != nil) %>
          <div class="ui-grid-solo">
            <h1><center>some kind of title?</center></h1>
          </div>

          <ul data-role="listview" data-inset="true">
              <li data-role="list-divider">Profession A</li>
              <li><a href="">
                  <h2><%= program.title %></h2>
                  <p><%= program.description %></p>
              </a></li>
             <!--  <li><a href="index.html">
                  <h2>Name of Opportunity</h2>
                  <p>description</p>
              </a></li>
              <li data-role="list-divider">Profession B</li>
              <li><a href="">
                  <h2>Name of Opportunity</h2>
                  <p>description</p>
              </a></li> -->
          </ul>
        <% end %>
      <% end %>
    </div>     

    <!--Panel: Contains the filter options through a panel that pushes out -->
    <div data-role="panel" data-display="push" id="filter_panel"> 
      <h1><center>filters</center></h1>
<!--       <div data-role="header" id = "panel_header">
        <p id = "filter_title">filters</p>
      </div> -->

        <%= form_for(@program, :method => :post, :url => {:action => :analyze_filters, :id => @program.id}) do |form| %>
          <div class="ui-field-contain">
            <div>
              <%= form.text_field :title, :placeholder => "program name..." %>
            </div>

            <div>
              <%= form.text_field :price, :placeholder => "price..." %> 
            </div>    

            <div>
              <%= form.select(:region, @all_regions,{ :prompt => "select a region"}, class: "region_selector", :name => "region_name") %>
            
            </div>
            <div>
              <%= form.select(:professions, @user_professions,{ :prompt => "select a profession"}, class: "profession_selector", :name => "profession_name") %>
            </div>

            <div>
              <%= radio_button_tag(:housing_type, "Housed") %>
              <%= label_tag(:housing_type_Housed, "Housed") %>
              <%= radio_button_tag(:housing_type, "Unhoused") %>
              <%= label_tag(:housing_type_Unhoused, "Unhoused") %>
            </div>

            <div>
              <%= radio_button_tag(:paid, "yes") %>
              <%= label_tag(:paid_yes, "Strong preference toward paid") %>
              <%= radio_button_tag(:paid, "no") %>
              <%= label_tag(:paid_no, "Unpaid is also acceptable") %>
            </div>
                
            <div>
              <%= form.submit "Filter Results", :id => "submit_button" %>
            </div>  

          </div>
      <% end %> <!-- ends the form -->
    </div>

    
  <% end %> <!-- ends the if/else statement -->
</div>


